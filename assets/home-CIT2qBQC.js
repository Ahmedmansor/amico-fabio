import"./global-header-4j9IadTc.js";import"./ui-layout-YpVXqCmA.js";import"./global-footer-D0aab2x-.js";import"./trips-renderer-CJODgN6j.js";import"./main-DTrlTtC4.js";const a={init:()=>{const n=document.getElementById("hero-slider-section");if(!n)return;const t=n.querySelectorAll(".hero-slide");!t||t.length===0||a.start(t)},start:n=>{let t=0;const i=s=>{n.forEach(o=>o.classList.remove("active-slide")),n[s].classList.add("active-slide")},e=()=>{t=(t+1)%n.length,i(t)};i(0),setInterval(e,3e3)}};document.readyState==="loading"?window.addEventListener("load",a.init):a.init();window.HeroSlider=a;const d=typeof window<"u"&&window.location&&window.location.pathname?window.location.pathname.split("/"):[],l=d.filter(Boolean)[0]||"",m=l?`/${l}/`:"/",f=typeof window<"u"&&window.FABIO_BASE_URL||m;window.PromoBanner={render:n=>{const t=document.getElementById("promo-banner-container");if(!t||!n)return;let i=null;if(Array.isArray(n)?i=n.find(c=>c.key==="promo_banner"):i=n,!i)return;if(!(String(i.is_active).toUpperCase()==="TRUE")){t.innerHTML="",t.style.display="none";return}const r=`
      <div style="
          position: fixed;
          top: 115px; /* المسافة من فوق */
          left: 50%;
          transform: translateX(-50%); /* السحر اللي بيوسطنه */
          z-index: 9999;
          width: 90%;
          max-width: 500px;
      ">
        <div class="bg-gradient-to-r from-yellow-500 via-yellow-400 to-yellow-500 text-black border border-white/30 shadow-2xl rounded-2xl px-4 py-3 flex items-center justify-between">
          <div class="flex-1 text-center font-bold text-sm md:text-base tracking-wide" style="font-family: 'Montserrat', sans-serif;">
            ${(localStorage.getItem("lang")||"it")==="en"?i.val_en:i.val_it}
          </div>
          <button type="button" 
                  style="background: transparent; border: none; margin-left: 12px; cursor: pointer; display: flex; align-items: center;"
                  onclick="window.PromoBanner.dismiss()" 
                  aria-label="Close">
            <img src="${f}assets/images/icons/close-icon.svg" alt="Close" style="width: 24px; height: 24px; display: block;" />
          </button>
        </div>
      </div>
    `;t.innerHTML=r,t.style.display="block"},dismiss:()=>{const n=document.getElementById("promo-banner-container");n&&(n.style.transition="opacity 0.5s ease-out",n.style.opacity="0",setTimeout(()=>{n.style.display="none",n.innerHTML="",n.style.opacity="1"},500))}};class h{constructor(t){this.container=typeof t=="string"?document.querySelector(t):t,this.container&&(this.bg=this.container.querySelector(".wf-bg"),this.fig=this.container.querySelector(".wf-figure"),this.bioBtn=this.container.querySelector(".wf-bio-btn"),this.overlay=document.querySelector(".wf-overlay-bio"),this.overlayContent=this.overlay?this.overlay.querySelector(".wf-overlay-content"):null,this.isBioActive=!1,this.active=!1,this.rafId=null,this.tx=0,this.ty=0,this.cx=0,this.cy=0,this.intensityBg=.15,this.intensityFg=.4,this.amplitude=50,this.iosPermissionRequested=!1,this.onMouseMove=this.onMouseMove.bind(this),this.onOrientation=this.onOrientation.bind(this),this.onResize=this.onResize.bind(this),this.tick=this.tick.bind(this),this.requestOrientationPermission=this.requestOrientationPermission.bind(this),this.observer=new IntersectionObserver(this.onIntersect.bind(this),{root:null,threshold:.6}),this.observer.observe(this.container),this.onResize(),window.addEventListener("resize",this.onResize,{passive:!0}),this.attachPermissionTriggers(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.attachBioInteractions()):this.attachBioInteractions())}onResize(){const t=this.container.getBoundingClientRect();this.cx=t.left+t.width/2,this.cy=t.top+t.height/2,this.amplitude=(window.innerWidth||0)>1440?15:50}onIntersect(t){const i=t&&t[0];i&&(i.isIntersecting?this.activate():this.deactivate())}activate(){this.active||(this.active=!0,window.addEventListener("mousemove",this.onMouseMove,{passive:!0}),typeof window.DeviceOrientationEvent<"u"&&(typeof window.DeviceOrientationEvent.requestPermission=="function"||window.addEventListener("deviceorientation",this.onOrientation,{passive:!0})),this.rafId||(this.rafId=requestAnimationFrame(this.tick)))}deactivate(){this.active&&(this.active=!1,window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("deviceorientation",this.onOrientation),this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.resetTransforms())}dispose(){this.deactivate(),this.observer&&(this.observer.disconnect(),this.observer=null),window.removeEventListener("resize",this.onResize)}onMouseMove(t){const i=t.clientX-this.cx,e=t.clientY-this.cy,s=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),o=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),r=i/(s/2),c=e/(o/2);this.tx=Math.max(-1,Math.min(1,r)),this.ty=Math.max(-1,Math.min(1,c))}onOrientation(t){const i=typeof t.beta=="number"?t.beta:0,e=typeof t.gamma=="number"?t.gamma:0,s=Math.max(-1,Math.min(1,i/45)),o=Math.max(-1,Math.min(1,e/45));this.tx=o,this.ty=s}async requestOrientationPermission(){try{if(this.iosPermissionRequested||typeof window.DeviceOrientationEvent>"u"||typeof window.DeviceOrientationEvent.requestPermission!="function")return;const t=await window.DeviceOrientationEvent.requestPermission();this.iosPermissionRequested=!0,String(t).toLowerCase()==="granted"&&window.addEventListener("deviceorientation",this.onOrientation,{passive:!0})}catch{}}attachPermissionTriggers(){const t=i=>{const e=i.target;if(!e)return;const s=e.closest(".hero-btn"),o=e.closest("#gh-lang-btn"),r=e.closest(".gh-lang-item");(s||o||r)&&this.requestOrientationPermission()};document.addEventListener("click",t)}attachBioInteractions(){if(this.bioBtn&&this.bioBtn.addEventListener("click",t=>{if(t.stopPropagation(),!this.active)return;console.log("WhoFabio: bio button clicked");const e=(localStorage.getItem("fabio_lang")||document.documentElement.lang||"it")==="en"?window.i18nEn||{}:window.i18nIt||{},s=e&&e.secrets&&e.secrets.page6&&e.secrets.page6.intro;console.log("Target Text:",s),setTimeout(()=>this.setBioText(),10),this.isBioActive=!0,this.overlay&&this.overlay.classList.add("is-visible")}),this.overlay){const t=this.overlay.querySelector(".wf-overlay-close");t&&t.addEventListener("click",()=>{console.log("WhoFabio: bio overlay closed"),this.isBioActive=!1,this.overlay.classList.remove("is-visible")}),this.overlay.addEventListener("click",i=>{i.target===this.overlay&&(console.log("WhoFabio: bio overlay click-outside"),this.isBioActive=!1,this.overlay.classList.remove("is-visible"))})}}setBioText(){const t=this.overlay?this.overlay.querySelector(".wf-overlay-text"):null;if(!t)return;const e=(localStorage.getItem("fabio_lang")||document.documentElement.lang||"it")==="en"?window.i18nEn||{}:window.i18nIt||{},s=e&&e.secrets&&e.secrets.page6&&e.secrets.page6.intro;typeof s=="string"&&(t.innerText=s)}tick(){this._cx||(this._cx=0),this._cy||(this._cy=0);const t=.12;this._cx+=(this.tx-this._cx)*t,this._cy+=(this.ty-this._cy)*t,this.applyTransforms(this._cx,this._cy),this.rafId=requestAnimationFrame(this.tick)}applyTransforms(t,i){const e=this.isBioActive?.25:1;if(this.bg){const s=-t*(this.amplitude*e)*this.intensityBg,o=-i*(this.amplitude*e)*this.intensityBg;this.bg.style.transform=`translate3d(${s}px, ${o}px, 0) scale(1.1)`}if(this.fig){const s=t*(this.amplitude*e)*this.intensityFg,o=i*(this.amplitude*e)*this.intensityFg;this.fig.style.transform=`translate3d(${s}px, ${o}px, 0)`}}resetTransforms(){this.bg&&(this.bg.style.transform="translate3d(0,0,0) scale(1.1)"),this.fig&&(this.fig.style.transform="translate3d(0,0,0)"),this.tx=0,this.ty=0,this._cx=0,this._cy=0}}window.WhoFabioParallax=h;(function(){const n=document.getElementById("who-fabio");n&&(window.WFParallax=new h(n))})();
